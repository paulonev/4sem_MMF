(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     32092,        822]
NotebookOptionsPosition[     31293,        793]
NotebookOutlinePosition[     31636,        808]
CellTagsIndexPosition[     31593,        805]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:043c\:0435\:0442\:043e\:0434", " ", 
    "\:043e\:043f\:0440\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:044f", " ",
     "\:043e\:043a\:0442\:0430\:043d\:0430", " ", "\:0432", " ", 
    "\:043a\:043e\:0442\:043e\:0440\:043e\:043c", " ", 
    "\:043b\:0435\:0436\:0438\:0442", " ", 
    "\:0432\:0435\:043a\:0442\:043e\:0440", " ", 
    SubscriptBox["p", "0"], 
    SubscriptBox["p", "i"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"whatOctan", "[", 
     RowBox[{"point1_", ",", "point2_"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"vector", ",", "x", ",", "y"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vector", " ", "=", " ", 
        RowBox[{"point2", " ", "-", " ", "point1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"vector", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", " ", 
       RowBox[{"y", " ", "=", " ", 
        RowBox[{"vector", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "y"}], "&&", " ", 
          RowBox[{"y", "<", "x"}]}], ",", 
         RowBox[{"Return", "[", "1", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "<", "x"}], "&&", " ", 
          RowBox[{"x", "<=", "y"}]}], ",", 
         RowBox[{"Return", "[", "2", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"-", "x"}]}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"-", "x"}], "<", "y"}]}], ",", 
         RowBox[{"Return", "[", "3", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "<", "y"}], " ", "&&", " ", 
          RowBox[{"y", "\[LessEqual]", 
           RowBox[{"-", "x"}]}]}], ",", 
         RowBox[{"Return", "[", "4", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "\[LessEqual]", 
           RowBox[{"-", "y"}]}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"-", "y"}], "<", 
           RowBox[{"-", "x"}]}]}], ",", 
         RowBox[{"Return", "[", "5", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "<", 
           RowBox[{"-", "x"}]}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"-", "x"}], "\[LessEqual]", "y"}]}], ",", 
         RowBox[{"Return", "[", "6", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "x"}], " ", "&&", " ", 
          RowBox[{"x", "<", 
           RowBox[{"-", "y"}]}]}], ",", 
         RowBox[{"Return", "[", "7", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "<", 
           RowBox[{"-", "y"}]}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"-", "y"}], "<", "x"}]}], ",", 
         RowBox[{"Return", "[", "8", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "0", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7612101332125645`*^9, 3.7612101358622293`*^9}, {
  3.7612382369352145`*^9, 3.7612382381371746`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:043c\:0435\:0442\:043e\:0434", " ", 
    "\:043e\:043f\:0440\:0435\:0434\:0435\:043b\:044f\:044e\:0449\:0438\:0439\
", " ", "\:0432\:0437\:0430\:0438\:043c\:043d\:043e\:0435", " ", 
    "\:0440\:0430\:0441\:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:0435\
", " ", "\:0434\:0432\:0443\:0445", " ", 
    "\:043e\:0442\:0440\:0435\:0437\:043a\:043e\:0432"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IsIntersecting", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p3_", ",", "p4_"}], "}"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d1", ",", "d2", ",", "d3", ",", "d4"}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{"d1", " ", "=", " ", 
        RowBox[{"Det", "[", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"p4", "-", "p3"}], ",", 
           RowBox[{"p1", "-", "p3"}]}], "}"}], "]"}]}], ";", " ", 
       RowBox[{"d2", " ", "=", " ", 
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p4", "-", "p3"}], ",", 
           RowBox[{"p2", "-", "p3"}]}], "}"}], "]"}]}], ";", " ", 
       RowBox[{"d3", " ", "=", " ", 
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p2", "-", "p1"}], ",", 
           RowBox[{"p3", "-", "p1"}]}], "}"}], "]"}]}], ";", " ", 
       RowBox[{"d4", " ", "=", " ", 
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p2", "-", "p1"}], ",", 
           RowBox[{"p4", "-", "p1"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s1", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"p3", "-", "p1"}], ",", 
          RowBox[{"p4", "-", "p1"}]}], "]"}]}], ";", 
       RowBox[{"s2", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"p3", "-", "p2"}], ",", 
          RowBox[{"p4", "-", "p2"}]}], "]"}]}], ";", 
       RowBox[{"s3", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"p3", "-", "p1"}], ",", 
          RowBox[{"p3", "-", "p2"}]}], "]"}]}], ";", 
       RowBox[{"s4", "=", 
        RowBox[{"Dot", "[", 
         RowBox[{
          RowBox[{"p4", "-", "p1"}], ",", 
          RowBox[{"p4", "-", "p2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"d1", "==", "d2", "==", "d3", "==", "d4", "==", "0"}], " ", 
         ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"s1", " ", "\[LessEqual]", "0"}], " ", "||", " ", 
            RowBox[{"s2", " ", "\[LessEqual]", "0"}], " ", "||", " ", 
            RowBox[{"s3", "\[LessEqual]", "0"}], " ", "||", " ", 
            RowBox[{"s4", " ", "\[LessEqual]", "0"}]}], ",", 
           RowBox[{"Return", "[", "True", "]"}], ",", 
           RowBox[{"Return", "[", "False", "]"}]}], "]"}], 
         "\[IndentingNewLine]", "\t", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d1", "*", "d2"}], " ", "\[LessEqual]", " ", "0"}], 
             ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d3", "*", "d4"}], "\[LessEqual]", "0"}], ")"}]}], ",", 
           RowBox[{"Return", "[", "True", "]"}], ",", 
           RowBox[{"Return", "[", "False", "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.761198630447905*^9, 3.761198657180213*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneratePolygon", "[", "no_", "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Po", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "15"}], "}"}], "]"}], ",", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "15"}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "15"}], "}"}], "]"}], ",", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "15"}], "}"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "15"}], "}"}], "]"}], ",", 
           RowBox[{"RandomReal", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "15"}], "}"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"remain", "=", "True"}], ",", "intersect", ",", "cur", ",", "i",
       ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{"remain", ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "3"}], ",", 
         RowBox[{"i", "<", "no"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"intersect", "=", "False"}], ";", "\[IndentingNewLine]", 
          RowBox[{"cur", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "15"}], "}"}], "]"}], ",", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{"0", ",", "15"}], "}"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{
             RowBox[{"j", "<", 
              RowBox[{"i", "-", "1"}]}], "&&", 
             RowBox[{"!", "intersect"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"IsIntersecting", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "Po", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ",", "cur"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "Po", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"Po", "\[LeftDoubleBracket]", 
                   RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"intersect", "=", "True"}]}], "]"}]}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "\:0435\:0441\:043b\:0438", " ", 
              "\:043f\:0440\:043e\:0438\:0437\:043e\:0448\:043b\:043e", " ", 
              "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\
\:0435"}], ",", " ", 
             RowBox[{
             "\:0442\:043e", " ", 
              "\:0441\:0447\:0451\:0442\:0447\:0438\:043a", " ", 
              "\:0432\:0435\:0440\:0448\:0438\:043d", " ", 
              "\:0443\:043c\:0435\:043d\:044c\:0448\:0430\:0435\:043c", " ", 
              "\:043d\:0430", " ", "1", " ", "\:0438", " ", 
              "\:0432\:044b\:0431\:0438\:0440\:0430\:0435\:043c", " ", 
              "\:043d\:043e\:0432\:0443\:044e", " ", 
              "\:0432\:0435\:0440\:0448\:0438\:043d\:0443"}]}], "*)"}], 
           "\[IndentingNewLine]", "\t      ", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "\[Equal]", 
              RowBox[{"no", "-", "1"}]}], "&&", 
             RowBox[{"!", "intersect"}]}], ",", "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", "then", "*)"}], "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "2"}], ",", 
               RowBox[{
                RowBox[{"j", "<", "i"}], "&&", 
                RowBox[{"!", "intersect"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"IsIntersecting", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "Po", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "cur"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "Po", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"Po", "\[LeftDoubleBracket]", 
                    RowBox[{"j", "+", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"intersect", "=", "True"}]}], "]"}]}], 
              "\[IndentingNewLine]", "\t      ", "]"}], ";", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"intersect", "\[Equal]", "False"}], ",", 
               RowBox[{"remain", "=", "False"}]}], "]"}]}]}], 
           RowBox[{"(*", 
            RowBox[{"exit", " ", "=", " ", 
             RowBox[{
             "false", " ", "\:0437\:043d\:0430\:0447\:0438\:0442", " ", 
              "\:0447\:0442\:043e", " ", "\:0432\:0441\:0435", " ", 
              "\:0432\:0435\:0440\:0448\:0438\:043d\:044b", " ", 
              "\:043f\:043e\:0434\:043e\:0431\:0440\:0430\:043d\:044b"}]}], 
            "*)"}], "\[IndentingNewLine]", "\t", 
           RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "\:0434\:043e\:0431\:0430\:0432\:043b\:0435\:043d\:0438\:0435", 
             " ", "\:0432\:0435\:0440\:0448\:0438\:043d\:044b", " ", "\:0432",
              " ", "\:043c\:043d"}], "-", "\:043d\:0438\:043a"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", "intersect"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"Po", ",", "cur"}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "\:0435\:0441\:043b\:0438", " ", 
             "\:043f\:0440\:043e\:0438\:0437\:043e\:0448\:043b\:043e", " ", 
             "\:043f\:0435\:0440\:0435\:0441\:0435\:0447\:0435\:043d\:0438\
\:0435"}], ",", " ", 
            RowBox[{
            "\:0442\:043e", " ", "\:0441\:0447\:0451\:0442\:0447\:0438\:043a",
              " ", "\:0432\:0435\:0440\:0448\:0438\:043d", " ", 
             "\:0443\:043c\:0435\:043d\:044c\:0448\:0430\:0435\:043c", " ", 
             "\:043d\:0430", " ", "1", " ", "\:0438", " ", 
             "\:0432\:044b\:0431\:0438\:0440\:0430\:0435\:043c", " ", 
             "\:043d\:043e\:0432\:0443\:044e", " ", 
             "\:0432\:0435\:0440\:0448\:0438\:043d\:0443"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"i", "--"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "Po", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7611985481640415`*^9, 3.761198598088386*^9}, {
  3.7611986758426886`*^9, 3.7611986922733626`*^9}, {3.761199190193824*^9, 
  3.761199201519208*^9}, {3.761199365747627*^9, 3.7611993761800733`*^9}, {
  3.7611998922124095`*^9, 3.7611999347017717`*^9}, {3.7612000051911707`*^9, 
  3.7612000810505676`*^9}, {3.7612001140478373`*^9, 3.761200145645486*^9}, {
  3.7612002432972007`*^9, 3.7612002484955196`*^9}, {3.7612003112366796`*^9, 
  3.7612003531354628`*^9}, {3.761200384781004*^9, 3.7612004071604443`*^9}, {
  3.7612014347369947`*^9, 3.7612014691796803`*^9}, {3.761201894742803*^9, 
  3.761201924411271*^9}, {3.7612104193965216`*^9, 3.7612104607208586`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"isInnerPoint", "[", 
   RowBox[{"P_", ",", "p0_"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"X", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"Y", "=", 
       RowBox[{"{", "}"}]}], ",", "det", ",", 
      RowBox[{"sum", " ", "=", " ", "0"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "\:0433\:0430\:0431\:0430\:0440\:0438\:0442\:043d\:044b\:0439", " ", 
      "\:0442\:0435\:0441\:0442"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "P", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"X", ",", 
          RowBox[{"P", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"Y", ",", 
          RowBox[{"P", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["x", "min"], "=", " ", 
      RowBox[{"Min", "[", "X", "]"}]}], ";", " ", 
     RowBox[{
      SubscriptBox["x", "max"], "=", " ", 
      RowBox[{"Max", "[", "X", "]"}]}], ";", " ", 
     RowBox[{
      SubscriptBox["y", "min"], "=", " ", 
      RowBox[{"Min", "[", "Y", "]"}]}], ";", " ", 
     RowBox[{
      SubscriptBox["y", "max"], "=", " ", 
      RowBox[{"Max", "[", "Y", "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"--", 
        RowBox[{"--", "\:043a\:043e\:043d\:0435\:0446"}]}], " ", 
       "\:0433\:0430\:0431\:0430\:0440\:0438\:0442\:043d\:043e\:0433\:043e", 
       " ", 
       RowBox[{
        RowBox[{"\:0442\:0435\:0441\:0442\:0430", "--"}], "--"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"p0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          " ", "<", " ", 
         SubscriptBox["x", "min"]}], " ", "||", " ", 
        RowBox[{
         RowBox[{"p0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          " ", ">", " ", 
         SubscriptBox["x", "max"]}], "||", 
        RowBox[{
         RowBox[{"p0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
          "<", 
         SubscriptBox["y", "min"]}], "||", 
        RowBox[{
         RowBox[{"p0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
          ">", 
         SubscriptBox["y", "max"]}]}], ",", 
       RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"Length", "[", "P", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Delta]", "i"], "=", " ", 
         RowBox[{"whatOctan", "[", 
          RowBox[{"p0", ",", 
           RowBox[{
           "P", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t", 
        RowBox[{
         SubscriptBox["\[Delta]", 
          RowBox[{"i", "+", "1"}]], "=", " ", 
         RowBox[{"whatOctan", "[", 
          RowBox[{"p0", ",", 
           RowBox[{"P", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\t", 
        RowBox[{
         SubscriptBox["\[CapitalDelta]", "i"], "=", " ", 
         RowBox[{
          SubscriptBox["\[Delta]", 
           RowBox[{"i", "+", "1"}]], " ", "-", " ", 
          SubscriptBox["\[Delta]", "i"]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", 
         RowBox[{
         "\:0448\:0430\:0433", " ", 
          "\"\<\:043a\:043e\:0440\:0440\:0435\:043a\:0446\:0438\:044f\>\""}], 
         "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "i"], " ", ">", " ", "4"}], ",", 
          " ", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "i"], " ", "=", " ", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "i"], "-", "8"}]}], ",", 
          RowBox[{"(*", "else", "*)"}], 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "i"], " ", "<", " ", 
             RowBox[{"-", "4"}]}], ",", " ", 
            RowBox[{
             SubscriptBox["\[CapitalDelta]", "i"], " ", "=", " ", 
             RowBox[{
              SubscriptBox["\[CapitalDelta]", "i"], "+", "8"}]}], ",", 
            "\[IndentingNewLine]", "\t", 
            RowBox[{"(*", "else", "*)"}], "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                SubscriptBox["\[CapitalDelta]", "i"], "\[Equal]", " ", "4"}], 
               " ", "||", " ", 
               RowBox[{
                SubscriptBox["\[CapitalDelta]", "i"], "\[Equal]", " ", 
                RowBox[{"-", "4"}]}]}], " ", ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"(*", "then", "*)"}], "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"det", " ", "=", " ", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "P", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "p0"}], ",", 
                   RowBox[{
                    RowBox[{"P", "\[LeftDoubleBracket]", 
                    RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
                    "p0"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
               "\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"det", " ", "<", " ", "0"}], ",", 
                 RowBox[{
                  SubscriptBox["\[CapitalDelta]", "i"], " ", "=", 
                  RowBox[{"-", "4"}]}], ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"det", " ", ">", " ", "0"}], " ", ",", 
                   RowBox[{
                    SubscriptBox["\[CapitalDelta]", "i"], " ", "=", "4"}], 
                   ",", 
                   RowBox[{"Return", "[", "\"\<Lie on edge\>\"", "]"}]}], 
                  "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "\t", "]"}]}], 
           "\[IndentingNewLine]", "\t", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"sum", " ", "=", " ", 
         RowBox[{"sum", "+", 
          SubscriptBox["\[CapitalDelta]", "i"]}]}], ";"}]}], 
      "\[IndentingNewLine]", "     ", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", "\:043f\:0440\:043e\:0432\:0435\:0440\:043a\:0430", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sum", " ", "\[Equal]", " ", "8"}], " ", "||", " ", 
        RowBox[{"sum", " ", "\[Equal]", " ", 
         RowBox[{"-", "8"}]}]}], ",", " ", 
       RowBox[{"Return", "[", "True", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"sum", "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", "False", "]"}], ",", 
         RowBox[{"Return", "[", "\"\<Some mistake happened\>\"", "]"}]}], 
        "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.761205951633198*^9, 3.761205986305512*^9}, 
   3.761206021027824*^9, {3.7612060605062056`*^9, 3.7612067372724404`*^9}, {
   3.761208177327095*^9, 3.761208535373728*^9}, {3.7612088433272457`*^9, 
   3.7612089227107987`*^9}, {3.761208966916973*^9, 3.7612091326491404`*^9}, {
   3.7612092237208047`*^9, 3.7612094475852776`*^9}, {3.761210226424115*^9, 
   3.761210327670292*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"P", " ", "=", " ", 
  RowBox[{"GeneratePolygon", "[", "5", "]"}]}]], "Input",
 CellChangeTimes->{3.7612103876654825`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"7.470061437348658`", ",", "9.46285365996609`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10.86096491185491`", ",", "1.4857799240067529`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5328581880817254`", ",", "2.6279093690995907`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.447856507879443`", ",", "6.136560224115076`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9.424767428923559`", ",", "1.883997642927941`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7612103880777397`*^9, 3.7612382444696274`*^9, 
  3.761238377562154*^9, 3.7612764544417405`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<x=\>\"", ",", 
    RowBox[{"Dynamic", "[", "x", "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Slider", "[", 
   RowBox[{
    RowBox[{"Dynamic", "[", "x", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "15"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "dynamically", " ", "express", " ", "x", " ", "value", " ", "of", " ", 
    "point"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<y=\>\"", ",", 
    RowBox[{"Dynamic", "[", "y", "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Slider", "[", 
   RowBox[{
    RowBox[{"Dynamic", "[", "y", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "15"}], "}"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "dynamically", " ", "express", " ", "y", " ", "value", " ", "of", " ", 
    "point"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"isInnerPoint", "[", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"P", ",", 
       RowBox[{"P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "dynamically", " ", "show", " ", "position", " ", "of", " ", "point", " ", 
    "relatively", " ", "to", " ", "poly"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Graphics", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"Append", "[", 
       RowBox[{"P", ",", 
        RowBox[{"P", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", "LightGray", 
     ",", 
     RowBox[{"Polygon", "[", "P", "]"}], ",", "Black", ",", 
     RowBox[{"PointSize", "[", ".01", "]"}], ",", 
     RowBox[{"Point", "/@", "P"}], ",", 
     RowBox[{"PointSize", "[", "0.015", "]"}], ",", 
     RowBox[{"Point", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Dynamic", "[", "x", "]"}], ",", 
        RowBox[{"Dynamic", "[", "y", "]"}]}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "17"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "Automatic"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.761209503585415*^9, 3.761209552012788*^9}, {
  3.7612103370686545`*^9, 3.7612103512728558`*^9}, {3.7612103819047513`*^9, 
  3.7612103834171305`*^9}, {3.761210470173715*^9, 3.761210481825739*^9}, {
  3.7612383051698008`*^9, 3.7612383509005218`*^9}, {3.761238397520252*^9, 
  3.761238425365551*^9}, {3.761276721916786*^9, 3.7612767379804764`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"x=\"\>", "\[InvisibleSpace]", 
   DynamicBox[ToBoxes[$CellContext`x, StandardForm],
    ImageSizeCache->{14., {0., 8.}}]}],
  SequenceForm["x=", 
   Dynamic[$CellContext`x]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.761210484424051*^9, 3.7612382445916395`*^9, {3.761238367251063*^9, 
   3.7612383775921555`*^9}}],

Cell[BoxData[
 SliderBox[Dynamic[$CellContext`x], {0, 15}]], "Output",
 CellChangeTimes->{
  3.7612104844290543`*^9, 3.761238244598641*^9, {3.761238367286056*^9, 
   3.761238377602153*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"y=\"\>", "\[InvisibleSpace]", 
   DynamicBox[ToBoxes[$CellContext`y, StandardForm],
    ImageSizeCache->{14., {0., 8.}}]}],
  SequenceForm["y=", 
   Dynamic[$CellContext`y]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.761210484424051*^9, 3.7612382445916395`*^9, {3.761238367251063*^9, 
   3.76123837760715*^9}}],

Cell[BoxData[
 SliderBox[Dynamic[$CellContext`y], {0, 15}]], "Output",
 CellChangeTimes->{
  3.7612104844290543`*^9, 3.761238244598641*^9, {3.761238367286056*^9, 
   3.761238377612152*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`isInnerPoint[
    AppendTo[$CellContext`P, 
     Part[$CellContext`P, 1]], {$CellContext`x, $CellContext`y}], 
   StandardForm],
  ImageSizeCache->{40., {0., 8.}}]], "Output",
 CellChangeTimes->{
  3.7612104844290543`*^9, 3.761238244598641*^9, {3.761238367286056*^9, 
   3.761238377617154*^9}}],

Cell[BoxData[
 GraphicsBox[{
   LineBox[{{9.52616159740452, 11.894694491314887`}, {4.403561007320246, 
    2.81933493926671}, {8.687903719246208, 2.4057879953306376`}, {
    12.481565609264095`, 10.836332025715414`}, {8.625354573183692, 
    4.359679772291628}, {9.52616159740452, 11.894694491314887`}, {
    9.52616159740452, 11.894694491314887`}}], 
   {GrayLevel[0.85], 
    PolygonBox[{{9.52616159740452, 11.894694491314887`}, {4.403561007320246, 
     2.81933493926671}, {8.687903719246208, 2.4057879953306376`}, {
     12.481565609264095`, 10.836332025715414`}, {8.625354573183692, 
     4.359679772291628}, {9.52616159740452, 11.894694491314887`}}]}, 
   {GrayLevel[0], PointSize[
    0.01], {PointBox[{9.52616159740452, 11.894694491314887`}], 
     PointBox[{4.403561007320246, 2.81933493926671}], 
     PointBox[{8.687903719246208, 2.4057879953306376`}], 
     PointBox[{12.481565609264095`, 10.836332025715414`}], 
     PointBox[{8.625354573183692, 4.359679772291628}], 
     PointBox[{9.52616159740452, 11.894694491314887`}]}, 
    {PointSize[0.015], 
     PointBox[{Dynamic[$CellContext`x], Dynamic[$CellContext`y]}]}}},
  AspectRatio->Automatic,
  PlotRange->{{0, 17}, {0, 17}}]], "Output",
 CellChangeTimes->{
  3.7612104844290543`*^9, 3.761238244598641*^9, {3.761238367286056*^9, 
   3.7612383776221476`*^9}}]
}, Open  ]]
},
WindowSize->{986, 676},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3718, 101, 472, "Input"],
Cell[4279, 123, 3737, 97, 434, "Input"],
Cell[8019, 222, 8701, 192, 918, "Input"],
Cell[16723, 416, 8205, 197, 788, "Input"],
Cell[CellGroupData[{
Cell[24953, 617, 145, 3, 31, "Input"],
Cell[25101, 622, 640, 15, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25778, 642, 2689, 74, 314, "Input"],
Cell[28470, 718, 374, 10, 23, "Print"],
Cell[28847, 730, 189, 4, 40, "Output"],
Cell[29039, 736, 371, 10, 23, "Print"],
Cell[29413, 748, 189, 4, 40, "Output"],
Cell[29605, 754, 345, 9, 31, "Output"],
Cell[29953, 765, 1324, 25, 375, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
